#!/usr/bin/env node
var rnc = require('../build/index.js');
var pkg = require('../package.json');
var path = require('path');
var fs = require('fs');
var argv = require('minimist')(process.argv.slice(2));

var help = argv['h'] || argv['help'];
var watch = argv['w'] || argv['watch'];
var inputArg = argv['_'][0] || argv['i'];
var outputArg = argv['_'][0] || argv['o'];

console.log('React-native-css - v' + pkg.version);

if (inputArg.length > 0 && outputArg.length > 0) {

	var input = path.resolve(process.cwd(), inputArg);
	var output = path.resolve(process.cwd(), outputArg);

	rnc.parse(input, output);

	if (watch) {
		console.log('ctrl + c to exit');

		fs.watch(process.cwd(), function (event, filename) {

			if (filename === argv['i']) {
				console.log(filename, ' compiling');
				rnc.parse(input, output);
			}
		});

	}
}

if (help) {
	console.log('\nCompile and watch: \n ./node_modules/.bin/react-native-css INPUT_CSS_FILE_AND_FULLPATH  OUTPUT_JS_FILE -w  \nCompile once: \n./node_modules/.bin/react-native-css INPUT_CSS_FILE_AND_FULLPATH OUTPUT_JS_FILE\n ');
	console.log('real example 1: ./node_modules/.bin/react-native-css -i ../css/main.css -o ../styles/main.js -w ');
	console.log('real example 2: ./node_modules/.bin/react-native-css ../css/main.css ../styles/main.js -w ');
}
